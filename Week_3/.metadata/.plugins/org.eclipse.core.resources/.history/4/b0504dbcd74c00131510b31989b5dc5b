/*
 * Project:	RecipeMe
 * 
 * Package: com.daletupling.recipeme
 * 
 * Author: 	Dale Tupling
 * 
 * Date:	November 8th, 2013
 * 
 */

package com.daletupling.recipeme;

import java.net.MalformedURLException;
import java.net.URL;

import android.os.AsyncTask;
import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.util.Log;
import android.view.Menu;
import android.view.ViewGroup.LayoutParams;
import android.widget.LinearLayout;
import android.widget.TextView;

public class MainActivity extends Activity {
	Context mContext;
	String[] recipeList;
	TextView recipeInfoText;
	private int _dataResults;
	String pulledData = null;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		mContext = this;

		//recipeList = //RecipeArray

		//Create Linear Layout
		LinearLayout linearL = new LinearLayout(mContext);
		//Create Linear Layout parameters
		LayoutParams layoutP = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
		//Set layout Params
		linearL.setLayoutParams(layoutP);
		//Set Layout Orientation
		linearL.setOrientation(LinearLayout.VERTICAL);
		
		
		
		
		
        //Get JSON Data and Filter through data to build arrays for Team name, location and nickname
        
        private class getData extends AsyncTask<String, Void, String> {
                @Override
                protected String doInBackground(String... params) {
                        String responseString = "";
                        try {
                        	
                        		String initalURL = "http://food2fork.com/api/search?key=d93b07b1067a7a5a8add2ee2ab7005bd&q=";
                                URL url = new URL(initalURL+searchString);
                                responseString = getResponse(url);
                        } catch (MalformedURLException e) {
                                responseString = "UhOh we made a mistake";
                                Log.e(TAG, "ERROR:", e);

                        }
                        return responseString;
                }

                @Override
                protected void onPostExecute(String result) {
                        Log.i("TRYING JSON", "trying json");
                        try {

                                JSONObject jsonObject = new JSONObject(result);
                                // Get Array sports from JSONObject
                                JSONArray sportsArray = jsonObject.getJSONArray("sports");
                                JSONObject sports = sportsArray.getJSONObject(0);
                                
                                // Get Leagues from JSON Object Sports
                                JSONArray leagues = sports.getJSONArray("leagues");
                                JSONObject nflTeams = leagues.getJSONObject(0);
                                // Get teams from NFL Object
                                JSONArray teams1 = nflTeams.getJSONArray("teams");
                                // Loop through teams array and set attributes value
                                for (int i = 0; i < teams1.length(); i++) {
                                        JSONObject names = teams1.getJSONObject(i);
                                        Log.i("TEAM ARRAY", names.toString());
                                        // Set Teams class object from data in array
                                        teamsName.add(names.getString("name"));
                                        teamsLocation.add(names.getString("location"));
                                        teamsNickName.add(names.getString("nickname"));
                                        viewSpinner.setSelection(0);
                                        
                                }
                        } catch (JSONException e) {
                                Log.e("JSONException", "ERROR", e);
                                e.printStackTrace();
                        }
                }
                
        }
        
		
		//Set content view to programmatic Linear Layout
		setContentView(linearL);
	}


	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.main, menu);
		return true;
	}

}
